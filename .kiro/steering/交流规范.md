---
inclusion: always
---

# PTE Player 开发规范

## 交流语言
- 使用中文进行所有对话、解释和文档编写
- 代码注释优先使用中文，英文注释需提供中文说明
- 变量和函数命名可使用英文，但需在注释中说明用途

## 开发工作流
- **确认优先**：编写代码前必须与用户确认需求和实现方案
- **渐进式实现**：先提供核心结构和关键逻辑，确认后再完整实现
- **主动沟通**：遇到技术细节不明确时立即询问用户

## 代码规范
### 文件编码
- **所有源代码文件必须使用UTF-8 with BOM编码格式**
- 确保中文注释和字符串能正确显示和编译
- 避免因编码问题导致的编译错误

### C++代码风格
- 遵循C++17标准和现有代码风格
- 类名使用PascalCase（如`ScoreRenderer`）
- 成员变量使用m_前缀（如`m_score`）
- 函数名使用camelCase（如`loadScore()`）
- 常量使用全大写加下划线（如`MAX_VOICES`）

### Qt6最佳实践
- 优先使用智能指针管理内存
- 使用Qt的信号槽机制进行组件通信
- QML属性绑定优于命令式更新
- 避免在QML中进行复杂计算

### 移动端优化
- 考虑Android平台的内存和CPU限制
- QML界面适配触屏操作（最小触摸目标44dp）
- 避免阻塞UI线程的长时间操作
- 使用异步加载大文件

## 架构原则
- **播放优先**：专注播放功能，避免复杂编辑功能
- **模块化设计**：保持各模块职责单一，降低耦合
- **格式兼容**：确保与PowerTab、GP7、GPX格式的兼容性
- **性能优先**：优化渲染和音频播放性能

## 文件组织
- 新增功能放在对应的模块目录下
- 每个模块包含独立的CMakeLists.txt
- 头文件和实现文件分离
- QML文件按功能分组到pages目录

## 错误处理
- 使用Qt的错误处理机制
- 文件加载失败时提供用户友好的错误信息
- 音频播放异常时优雅降级
- 记录关键操作的日志信息

